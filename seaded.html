<!DOCTYPE html>
<html lang="et">
<head>
<meta charset="UTF-8">
<title>Seaded</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script src="supabase.js"></script>
<script src="seaded.js"></script>
<style>
/* Üldine */
body {
    font-family: Arial, sans-serif;
    margin: 40px;
    background: #f7f9fc;
    color: #333;
}


/* Päis */
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
}

.header h2 {
    margin: 0;
    font-size: 26px;
    color: #2a4d8f;
}

.back-btn {
    background: #eb0d1550;
    color: white;
    border: none;
    padding: 8px 14px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
}
.back-btn:hover {
    background: #1ae131;
}

/* Tabelid */
table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 30px;
    background: white;
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

th {
    background: #e8eef7;
    color: #2a4d8f;
    padding: 10px;
    font-weight: bold;
    border-bottom: 2px solid #d0d8e4;
}

td {
    padding: 8px;
    border-bottom: 1px solid #eee;
}

tr:hover {
    background: #f3f7ff;
}

/* Sisestusväljad */
input {
    width: 100%;
    padding: 6px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

/* Tavalised nupud (sinised) */
button {
    margin-top: 10px;
    background: #2a4d8f;
    color: white;
    border: none;
    padding: 8px 14px;
    border-radius: 6px;
    cursor: pointer;
}
button:hover {
    background: #e71818;
}

/* Kustutamisnupp (punane) */
.delete-btn {
    background: #e81f18 !important;
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
    cursor: pointer;
}
.delete-btn:hover {
    background: #eb1710 !important;
}
</style>




</head>
<body>
<div class="header">
    <h2>Seaded</h2>
    <button class="back-btn" onclick="window.location='kassatabel.html'">Tagasi</button>
</div>
<body class="page-seaded">
<h2>Veerud</h2>
<table id="veeruTabel">
<thead>
<tr>
    <th>Pealkiri</th>
    <th>Nimi</th>
    <th>Hind</th>
    <th>Tüüp</th>
    <th>Kustuta</th>
</tr>
</thead>
<tbody></tbody>
</table>

<button onclick="lisaVeeruRida()">+ Lisa veerg</button>

<h2>Eripäevad</h2>
<table id="eripaevTabel">
<thead>
<tr>
    <th>Kuupäev</th>
    <th>Nimi</th>
    <th>Värv</th>
    <th>Kustuta</th>
</tr>
</thead>
<tbody></tbody>
</table>

<button onclick="lisaEripaevRida()">+ Lisa eripäev</button>

<script>
async function laeLeht() {
    const seaded = await laeSeaded();

    const tbody = document.querySelector("#veeruTabel tbody");
    tbody.innerHTML = "";

    seaded.veerud.forEach(v => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td><input value="${v.pealkiri}" onchange="uuendaVeerg(${v.id}, { pealkiri: this.value })"></td>
            <td><input value="${v.nimi}" onchange="uuendaVeerg(${v.id}, { nimi: this.value })"></td>
            <td><input value="${v.hind ?? ''}" onchange="uuendaVeerg(${v.id}, { hind: this.value })"></td>
            <td><input value="${v.tüüp}" onchange="uuendaVeerg(${v.id}, { tüüp: this.value })"></td>
            <td><button onclick="kustutaVeerg(${v.id}).then(laeLeht)">X</button></td>
        `;
        tbody.appendChild(tr);
    });

    const ebody = document.querySelector("#eripaevTabel tbody");
    ebody.innerHTML = "";

    Object.entries(seaded.eripaevad).forEach(([kuup, p]) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${kuup}</td>
            <td>${p.nimi}</td>
            <td><div style="width:20px;height:20px;background:${p.värv}"></div></td>
            <td><button onclick="kustutaEripaev('${kuup}').then(laeLeht)">X</button></td>
        `;
        ebody.appendChild(tr);
    });
}

function lisaVeeruRida() {
    lisaVeerg("uus", "Uus veerg", null, "tekst").then(laeLeht);
}

function lisaEripaevRida() {
    const kuup = prompt("Kuupäev (YYYY-MM-DD)");
    const nimi = prompt("Nimi");
    const värv = prompt("Värv (#rrggbb)");
    lisaEripaev(kuup, nimi, värv).then(laeLeht);
}

laeLeht();
</script>

</body>
</html>

